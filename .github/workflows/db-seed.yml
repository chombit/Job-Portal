name: Seed Render Database

on:
  workflow_dispatch:

jobs:
  seed:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Install dependencies
        run: cd backend && npm install --include=dev
      - name: Run migrations
        env:
          DATABASE_URL: ${{ secrets.RENDER_DB_URL }}
        run: |
          cd backend
          npx sequelize-cli db:migrate --url "$DATABASE_URL"
      - name: Run seeders
        env:
          DATABASE_URL: ${{ secrets.RENDER_DB_URL }}
        run: |
          cd backend
          npx sequelize-cli db:seed:all --url "$DATABASE_URL"
